<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Mehwish Birthday</title>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" crossorigin="anonymous">
<link href="https://fonts.googleapis.com/css2?family=Coiny&family=Titan+One&family=Nerko+One&family=Sriracha&family=Dancing+Script:wght@700&family=Poppins:wght@400;600&display=swap" rel="stylesheet" />
<link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link rel="preconnect" href="https://cdnjs.cloudflare.com" crossorigin>

<!-- Preload ảnh chính để paint nhanh -->
<link rel="preload" as="image" href="images/unnamed.png" fetchpriority="high">
<link rel="preload" as="image" href="images/1.png">

<style>
*{margin:0;padding:0;box-sizing:border-box}
:root{
  --pink:#feecea; --white:#fff; --black:#333; --text:#FF7882; --heart:#FF7882;
  --avatar-size:240px; --avatar-border:5px; --avatar-shift-right:20px;
}
html,body{height:100%}
body{min-height:100%;font-size:16px;background:var(--pink);position:relative}
#wrapper{position:relative;min-height:100%;overflow:hidden;z-index:1}

/* nền gif */
#background-gif{position:fixed;inset:0;background:transparent center/cover no-repeat fixed;opacity:.85;z-index:-1;pointer-events:none}

/* cờ + layout */
.flag__birthday{display:flex;justify-content:space-between;transform:translateY(-200px);animation:flag 1.5s 2s forwards}
@keyframes flag{to{transform:translateY(-10px)}}
.flag__left{transform:rotate(-10deg) translate(-20px,30px)}
.flag__right{transform:rotate(10deg) translate(20px,30px) scaleX(-1)}
.content{display:flex;gap:12px;padding-top:3rem}
.content .left,.content .right{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center}
.content .left{flex:0 0 40%}
.content .right{flex:0 0 60%}
.content .right .box__account{margin-left:var(--avatar-shift-right)}

/* tiêu đề */
.title{font-family:"Titan One",sans-serif;font-size:3rem;display:flex;flex-direction:column;align-items:center}
.title .happy,.title .birthday{font-weight:700;display:flex;justify-content:center;text-shadow:4px 4px var(--black),-4px 4px var(--black),4px -4px var(--black),-4px -4px var(--black),4px 8px 0 var(--black)}
.title .happy{color:#fff}.title .birthday{color:var(--text)}
.title span{transform:translateY(50px);opacity:0;visibility:hidden;animation:txt .5s var(--t) forwards}
@keyframes txt{to{transform:translateY(0);opacity:1;visibility:visible}}
.title .hat{position:absolute;right:45px;top:-350px;transform:rotate(-40deg);z-index:-1;animation:hattop 4s 7s forwards ease}
@keyframes hattop{20%,30%{top:-30px;transform-origin:left;transform:rotate(-40deg)}35%,100%{top:-30px;transform:rotate(0)}}

/* date + name */
.date__of__birth,.name{display:flex;align-items:center;background:var(--text);border-radius:50px;margin-top:20px;font-family:"Sriracha",cursive}
.date__of__birth{border:3px solid var(--black);transform:translateY(-100px);z-index:-1;opacity:0;visibility:hidden;width:0;animation:dob 5s 9s forwards}
@keyframes dob{20%,40%{width:0;height:0;transform:translateY(0);opacity:1;visibility:visible}45%{width:300px;height:0}50%,100%{width:300px;height:50px}}
.name{position:absolute;padding:2px 12px;bottom:-10px;border:3px solid var(--black);font-family:'Dancing Script',cursive}
.date__of__birth span,.name span{font-weight:700;margin:0 40px}
.name span{font-size:1.3rem}

/* nút thư */
.left .btn{transform:scale(0);animation:scaleIn 2s 16s forwards ease-in-out}
#btn__letter{margin-top:30px;background:var(--text);padding:5px 15px;border-radius:50px;border:3px solid var(--black);font-family:"Sriracha",cursive;cursor:pointer;transition:.3s}
#btn__letter:hover{background:var(--heart);color:#fff;box-shadow:0 3px 8px rgba(0,0,0,.24)}
@keyframes scaleIn{0%{transform:scale(0)}10%{transform:scale(1.3)}20%{transform:scale(.7)}30%,100%{transform:scale(1)}}

/* avatar */
.box__account{position:relative;transform:translateY(700px);animation:drop 8s 7s forwards ease-in}
@keyframes drop{to{transform:translateY(0)}}
.image{width:var(--avatar-size);height:var(--avatar-size);border-radius:50%;overflow:hidden;border:var(--avatar-border) solid var(--black);display:flex;align-items:center}
.image img{width:100%;object-fit:cover}

/* bóng bay bên phải */
.balloon_one{position:absolute;top:-70px;left:-70px;animation:bal1 2s infinite linear}
@keyframes bal1{0%,50%,100%{transform-origin:bottom right;transform:rotate(0)}25%{transform:rotate(3deg)}75%{transform:rotate(-3deg)}}
.balloon_two{position:absolute;top:170px;right:-65px;z-index:-1;transform:rotate(10deg);animation:bal2 2s infinite linear}
@keyframes bal2{0%,50%,100%{transform-origin:bottom left;transform:rotate(10deg)}25%{transform:rotate(7deg)}75%{transform:rotate(13deg)}}

/* trang trí thêm (không chặn click) */
.custom-decor{position:absolute;inset:0;pointer-events:none;z-index:2}
.custom-decor .dec{position:absolute;left:var(--x);top:var(--y);transform:translate(-50%,-50%) rotate(var(--rot,0deg));width:var(--w,120px);filter:drop-shadow(0 3px 10px rgba(0,0,0,.08));animation:float 6s ease-in-out infinite alternate}
@keyframes float{from{transform:translate(-50%,-50%) rotate(var(--rot,0deg))}to{transform:translate(-50%,-56%) rotate(var(--rot,0deg))}}
.dec--top-mid { --x:52%; --y:20%; --w:140px; --rot:-4deg; }
.dec--left-low{ --x:14%; --y:66%; --w:150px; }
.dec--right-low{--x:81%; --y:72%; --w:170px; }
.dec--left-mid{ --x:18%; --y:82%; --w:160px; }

/* modal thư (giữ nguyên rút gọn) */
.box__letter{position:fixed;inset:0;background:rgba(0,0,0,.5);z-index:10;display:none}
.letter__border{position:absolute;width:55vw;height:450px;background:#fff;border-radius:27px;padding:17px;box-shadow:0 3px 8px rgba(0,0,0,.24);top:50%;left:50%;transform:translate(-50%,-50%);display:none}
.letter__border .close{position:absolute;right:-10px;top:-10px;width:30px;height:30px;background:#fff;border-radius:50%;display:flex;justify-content:center;align-items:center;box-shadow:0 2px 8px rgba(99,99,99,.2);cursor:pointer}

/* Hộp quà – kéo lên cao */
#gift-boxes-area{position:fixed;left:50%;bottom:100px;transform:translateX(-50%);display:none;gap:28px;z-index:30}
.gift-box{width:96px;height:96px;display:grid;place-items:center;cursor:pointer;animation:gfloat 3.2s ease-in-out infinite}
.gift-box img{width:100%;filter:drop-shadow(0 10px 24px rgba(255,135,155,.35))}
@keyframes gfloat{0%{transform:translateY(0)}50%{transform:translateY(-18px)}100%{transform:translateY(0)}}
.gift-appear{animation:rise .9s ease-out forwards}
@keyframes rise{from{transform:translate(-50%,220px);opacity:0}to{transform:translate(-50%,0);opacity:1}}
.gift-box.removing{opacity:0!important;transform:scale(.6) translateY(20px)!important;pointer-events:none!important}

/* Modal lời chúc */
#gift-modal{position:fixed;inset:0;background:rgba(0,0,0,.45);backdrop-filter:blur(2px);display:none;align-items:center;justify-content:center;z-index:3000}
#gift-modal-content{background:#fffafc;color:#d1497a;border-radius:18px;padding:22px;min-width:240px;max-width:min(92vw,420px);text-align:center;box-shadow:0 10px 40px rgba(0,0,0,.25);font-family:'Dancing Script',cursive;font-size:1.4rem;position:relative}
#gift-modal-content img{max-width:100%;height:auto;border-radius:12px;margin-bottom:10px}
#gift-modal-close{position:absolute;right:14px;top:10px;font-size:1.7rem;color:#f67280;cursor:pointer}

/* PIN */
#pin-modal{position:fixed;inset:0;background:rgba(255,240,230,.96);display:flex;align-items:center;justify-content:center;z-index:9999}
.cute-pin-box{background:#ffe6ed;border:3.4px solid #e497af;border-radius:28px;box-shadow:0 4px 24px #e497af66;min-width:320px;min-height:340px;display:flex;flex-direction:column;align-items:center;padding:38px 28px 30px;color:#d1497a}
.cute-pin-title{font-family:'Dancing Script',cursive;font-size:2rem;margin-bottom:10px}
.cute-pin-dots{display:flex;gap:15px;margin:12px 0 18px}
.cute-pin-dot{width:24px;height:30px;border-radius:50% / 60%;border:2.5px solid #e497af;background:#fff6fb}
.cute-pin-dot.filled{background:radial-gradient(ellipse at 50% 40%, #fff 0 40%, #f67280 42% 100%);border-color:#d1497a}
.cute-pin-keypad{display:grid;grid-template-columns:repeat(3,86px);grid-gap:18px;justify-content:center}
.cute-pin-key{position:relative;width:86px;height:110px;border-radius:22px;border:3px solid #d1497a;background:#fff;cursor:pointer;display:grid;place-items:center;box-shadow:0 6px 0 #eeb9c8,0 8px 18px rgba(209,73,122,.25);transition:transform .08s}
.cute-pin-key:active{transform:translateY(2px)}
.cute-pin-key .chick{position:absolute;top:6px;left:50%;transform:translateX(-50%);width:42px;height:30px;background:#fff;border:3px solid #ff9db0;border-radius:18px}
.cute-pin-key .comb{position:absolute;top:-14px;left:50%;transform:translateX(-50%);font-size:16px;color:#ff4d6d;font-family:'Coiny',system-ui,sans-serif}
.cute-pin-key .eye{position:absolute;top:10px;width:6px;height:6px;background:#2d2d2d;border-radius:50%}
.eye.e1{left:11px}.eye.e2{right:11px}
.beak{position:absolute;top:14px;left:50%;transform:translateX(-50%);width:0;height:0;border-left:6px solid transparent;border-right:6px solid transparent;border-top:8px solid #ff9e2c}
.digit{position:absolute;bottom:8px;left:50%;transform:translateX(-50%);font-family:'Titan One','Coiny',system-ui,sans-serif;font-size:46px;color:#fff;text-shadow:-3px -3px 0 #222,3px -3px 0 #222,-3px 3px 0 #222,3px 3px 0 #222,0 5px 0 rgba(0,0,0,.12)}
.cute-pin-key.special .digit,.cute-pin-key.special .chick{display:none}
.cute-pin-key .label{font-weight:700;color:#d1497a;font-family:'Poppins',system-ui,sans-serif}

/* Nút bật nhạc khi autoplay bị chặn */
#music-unblock{position:fixed;right:14px;bottom:14px;z-index:5000;display:none;border:2px solid #d1497a;background:#fff0f7;color:#d1497a;border-radius:999px;padding:10px 16px;font-weight:600;box-shadow:0 4px 16px rgba(209,73,122,.25)}

@media (max-width:768px){
  .content{flex-direction:column;gap:25px;align-items:center;padding-top:2rem}
  .title{font-size:1.6rem;letter-spacing:6px}
  .image{width:200px;height:200px}
  #gift-boxes-area{bottom:78px;gap:16px}
  .gift-box{width:76px;height:76px}
}
</style>
</head>
<body>
<div id="background-gif" aria-hidden="true"></div>

<div id="wrapper">
  <div class="flag__birthday">
    <img src="images/1.png" width="350" height="120" class="flag__left" alt="">
    <img src="images/1.png" width="350" height="120" class="flag__right" alt="">
  </div>

  <!-- Decor đặt đúng các vùng trống -->
  <div class="custom-decor" aria-hidden="true">
    <img class="dec dec--top-mid"   src="images/party.png"    alt="">
    <img class="dec dec--left-low"  src="images/smile.png"    alt="">
    <img class="dec dec--right-low" src="images/balloon1.png" alt="">
    <img class="dec dec--left-mid"  src="images/clover.png"   alt="">
  </div>

  <div class="content">
    <div class="left">
      <div class="title">
        <h1 class="happy">
          <span style="--t:4s;">H</span><span style="--t:4.2s;">a</span><span style="--t:4.4s;">p</span><span style="--t:4.6s;">p</span><span style="--t:4.8s;">y</span>
        </h1>
        <h1 class="birthday">
          <span style="--t:5s;">B</span><span style="--t:5.2s;">i</span><span style="--t:5.4s;">r</span><span style="--t:5.6s;">t</span><span style="--t:5.8s;">h</span><span style="--t:6s;">d</span><span style="--t:6.2s;">a</span><span style="--t:6.4s;">y</span>
        </h1>
        <div class="hat"><img src="images/hat.png" width="130" height="130" alt=""></div>
      </div>

      <div class="date__of__birth"><span></span></div>
      <div class="btn">
        <button id="btn__letter"><div class="mail">Click Here Mehwish <i class="fa-regular fa-envelope"></i></div></button>
      </div>
    </div>

    <div class="right">
      <div class="box__account">
        <div class="image"><img src="images/unnamed.png" width="480" height="480" alt="avatar" fetchpriority="high" loading="eager"></div>
        <div class="name"><i class="fa-solid fa-heart"></i><span>Dear Mehwish</span><i class="fa-solid fa-heart"></i></div>
        <div class="balloon_one"><img width="100" height="140" src="images/balloon1.png" alt=""></div>
        <div class="balloon_two"><img width="100" height="140" src="images/balloon2.png" alt=""></div>
      </div>
    </div>
  </div>

  <!-- Hộp thư -->
  <div class="boxMail">
    <i class="fa-solid fa-xmark"></i>
    <div class="boxMail-container">
      <div class="card1">
        <div class="userImg"><img src="images/unnamed.png" alt=""></div>
        <h4 class="username">To: Mehwish 💖</h4>
        <h3>Happy Birthday</h3>
      </div>
      <div class="card2">
        <div class="card2-content">
          <h3>To You!</h3>
          <h2>Happy birthday 🥳🎂🥳 ... Always be happy 😌</h2>
        </div>
      </div>
    </div>
  </div>

  <!-- Modal Thư -->
  <div class="box__letter" style="display:none;">
    <div class="letter__border" style="display:none;">
      <div class="close"><i class="fa-solid fa-xmark"></i></div>
      <div class="letter">
        <div class="title__letter"></div>
        <div class="content__letter">
          <div class="left"><img id="heart__letter" src="images/heart.png" alt=""></div>
          <div class="right">
            <div class="love__img"><img src="images/love.png" alt=""></div>
            <div class="text__letter"><p></p></div>
            <img id="mewmew" src="images/cat.png" alt="">
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- 5 hộp quà -->
<div id="gift-boxes-area">
  <div class="gift-box" data-msg="Chúc Bé iu càng xinh đẹp 💖" data-img="images/1 (1).png"></div>
  <div class="gift-box" data-msg="Năm nay sinh nhật có anh 🎂" data-img="images/1 (10).png"></div>
  <div class="gift-box" data-msg="Làm gì cũng may mắn 🍀" data-img="images/1 (11).png"></div>
  <div class="gift-box" data-msg="Luôn cười tươi 😊" data-img="images/1 (12).png"></div>
  <div class="gift-box" data-msg="Happy Birthday 🎉💖" data-img="images/1 (9).png"></div>
</div>

<!-- Modal quà -->
<div id="gift-modal">
  <div id="gift-modal-content">
    <span id="gift-modal-close">&times;</span>
    <img id="gift-modal-img" src="" alt="">
    <div id="gift-modal-message"></div>
  </div>
</div>

<!-- Pháo hoa -->
<canvas id="fireworks"></canvas>

<!-- PIN -->
<div id="pin-modal">
  <div class="cute-pin-box">
    <div class="cute-pin-title">Nhập mã PIN</div>
    <div class="cute-pin-dots" id="pin-dots">
      <div class="cute-pin-dot"></div><div class="cute-pin-dot"></div><div class="cute-pin-dot"></div><div class="cute-pin-dot"></div>
    </div>
    <div class="cute-pin-keypad" id="pin-keypad"></div>
    <div class="cute-pin-error" id="pin-error"></div>
  </div>
</div>

<!-- audio local (tránh YouTube) -->
<audio id="unlock-music" src="music/happy.mp3" preload="metadata" loop playsinline></audio>
<button id="music-unblock">Bật nhạc 🎵</button>

<script src="https://code.jquery.com/jquery-3.7.1.min.js" crossorigin="anonymous"></script>

<script>
/* nền gif sau DOM */
document.addEventListener('DOMContentLoaded', () => {
  const bg = document.getElementById('background-gif');
  if (bg) bg.style.backgroundImage = 'url("https://i.pinimg.com/originals/b4/58/1d/b4581df9e47ce538d21555c94f75da95.gif")';
});
</script>

<!-- ===== GIFTS + FIREWORKS (định nghĩa trước) ===== -->
<script>
const GIFT_IMAGE_SRC="images/gift-cute.png";
(function(){
  const area=document.getElementById('gift-boxes-area');
  const modal=document.getElementById('gift-modal');
  const modalImg=document.getElementById('gift-modal-img');
  const modalMsg=document.getElementById('gift-modal-message');
  const modalClose=document.getElementById('gift-modal-close');
  const cvs=document.getElementById('fireworks');
  const ctx=cvs.getContext('2d');
  function fit(){cvs.width=innerWidth;cvs.height=innerHeight} fit(); addEventListener('resize',fit);

  let particles=[];
  function burst(x,y){for(let i=0;i<120;i++){particles.push({x,y,dx:(Math.random()-0.5)*6,dy:(Math.random()-0.5)*6,life:100,color:`hsl(${Math.random()*360},100%,50%)`});}}
  (function loop(){ctx.clearRect(0,0,cvs.width,cvs.height);for(let i=particles.length-1;i>=0;i--){const p=particles[i];p.x+=p.dx;p.y+=p.dy;p.life--;ctx.fillStyle=p.color;ctx.fillRect(p.x,p.y,2,2);if(p.life<=0)particles.splice(i,1);}requestAnimationFrame(loop)})();

  function renderGifts(){
    area.querySelectorAll('.gift-box').forEach(box=>{
      box.innerHTML=`<img class="gift-img" src="${GIFT_IMAGE_SRC}" alt="gift">`;
      box.addEventListener('click',ev=>{
        if (box.dataset.removed==='1') return;
        area.querySelectorAll('.gift-box.open').forEach(b=>b.classList.remove('open'));
        box.classList.add('open');
        const r=cvs.getBoundingClientRect(); burst(ev.clientX-r.left, ev.clientY-r.top);
        setTimeout(()=>{ modalImg.src=box.dataset.img||''; modalMsg.textContent=box.dataset.msg||'Happy Birthday!'; modal.style.display='flex'; area.style.visibility='hidden'; },300);
        box.dataset.removed='1'; box.style.pointerEvents='none';
        requestAnimationFrame(()=>{ void box.offsetWidth; box.classList.add('removing'); setTimeout(()=>box.remove(),600); });
      });
    });
  }
  modalClose.addEventListener('click',()=>{ modal.style.display='none'; area.style.visibility='visible'; area.querySelectorAll('.gift-box.open').forEach(b=>b.classList.remove('open')); });

  // expose
  window.HB_Gifts={
    init(){ renderGifts(); },
    show(){ area.style.display='flex'; area.classList.add('gift-appear'); }
  };
})();
</script>

<!-- ===== PIN (định nghĩa trước) ===== -->
<script>
(function(){
  const pinModal=document.getElementById('pin-modal');
  const pinDots=[...document.querySelectorAll('#pin-dots .cute-pin-dot')];
  const grid=document.getElementById('pin-keypad');
  const err=document.getElementById('pin-error');
  const music=document.getElementById('unlock-music');
  const musicBtn=document.getElementById('music-unblock');
  let entered='', correct='1010', onUnlock=()=>{};

  window.addEventListener('pointerdown', function prime(){
    if(!music) return; window.removeEventListener('pointerdown', prime);
    const m=music; const was=m.muted; m.muted=true; m.play().then(()=>{m.pause();m.currentTime=0;m.muted=was}).catch(()=>{});
  }, {once:true});

  function btnMusic(){ musicBtn.style.display='inline-flex'; }
  musicBtn.addEventListener('click', ()=>{ if(!music) return; musicBtn.style.display='none'; music.muted=false; music.currentTime=0; music.play().catch(btnMusic); });

  const KEYS=["1","2","3","4","5","6","7","8","9","del","0","ok"];
  function render(){
    const tile=(d)=>`<div class="chick"><span class="comb">❤</span><span class="eye e1"></span><span class="eye e2"></span><span class="beak"></span></div><span class="digit">${d}</span>`;
    KEYS.forEach(k=>{
      const b=document.createElement('button'); b.className='cute-pin-key';
      if(k==='del'){ b.classList.add('special'); b.innerHTML='<span class="label">⌫</span>'; }
      else if(k==='ok'){ b.classList.add('special'); b.innerHTML='<span class="label">OK</span>'; }
      else b.innerHTML=tile(k);
      b.onclick=()=>{
        if(k==='del'){ entered=entered.slice(0,-1); upd(); err.style.display='none'; }
        else if(k==='ok'){ check(); }
        else if(entered.length<4){ entered+=k; upd(); if(entered.length===4) setTimeout(check,160); }
      };
      grid.appendChild(b);
    });
  }
  function upd(){ pinDots.forEach((d,i)=>{ d.classList.toggle('filled',!!entered[i]); d.textContent=''; }); }
  function playMusic(){ if(!music) return; music.volume=.85; music.muted=false; const p=music.play(); if(p&&p.catch) p.catch(btnMusic); }
  function check(){
    if(entered===correct){ pinModal.style.display='none'; playMusic(); onUnlock&&onUnlock(); }
    else{ err.textContent="Sai mã PIN rồi 😳"; err.style.display='block'; entered=''; upd(); }
  }

  window.HB_Pin={
    require(opt={}){ correct=opt.pin||correct; onUnlock=typeof opt.onUnlock==='function'?opt.onUnlock:onUnlock; pinModal.style.display='flex'; entered=''; upd(); }
  };
  render(); upd();
})();
</script>

<!-- ===== Boot: gọi sau khi đã định nghĩa HB_Gifts & HB_Pin ===== -->
<script>
document.addEventListener('DOMContentLoaded', function () {
  // nền gif
  const bg = document.getElementById('background-gif');
  if (bg) bg.style.backgroundImage = 'url("https://i.pinimg.com/originals/b4/58/1d/b4581df9e47ce538d21555c94f75da95.gif")';

  // init & PIN
  if (window.HB_Gifts) HB_Gifts.init();
  if (window.HB_Pin) {
    HB_Pin.require({
      pin: '1010',
      onUnlock: function(){ setTimeout(()=>HB_Gifts && HB_Gifts.show(), 12000); }
    });
  } else {
    // Fallback nếu vì lý do gì đó PIN không load
    setTimeout(()=>HB_Gifts && HB_Gifts.show(), 12000);
  }
});
</script>
</body>
</html>
